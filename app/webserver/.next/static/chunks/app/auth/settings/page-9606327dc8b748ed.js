(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4651],{1254:(e,s,t)=>{"use strict";t.d(s,{default:()=>n});var r=t(4568),a=t(7620);let i=(0,t(8889).A)("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);var c=t(1874);function n(e){let{userId:s}=e,[t,n]=(0,a.useState)({emailNotifications:!0,newRecipeNotifications:!0,marketingNotifications:!1,securityNotifications:!0}),[o,d]=(0,a.useState)(!0),[l,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/users/".concat(s,"/notifications"));if(e.ok){let s=await e.json();n(s.preferences||{emailNotifications:!0,newRecipeNotifications:!0,marketingNotifications:!1,securityNotifications:!0})}}catch(e){console.error("알림 설정 불러오기 오류:",e)}finally{d(!1)}})()},[s]);let m=e=>{n(s=>({...s,[e]:!s[e]}))},h=async()=>{u(!0);try{let e=await fetch("/api/users/".concat(s,"/notifications"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({preferences:t})});if(e.ok)c.oR.success("알림 설정이 저장되었습니다");else{let s=await e.json();c.oR.error(s.error||"알림 설정 저장 중 오류가 발생했습니다")}}catch(e){console.error("알림 설정 저장 오류:",e),c.oR.error("서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요")}finally{u(!1)}};return o?(0,r.jsxs)("div",{className:"bg-card p-6 rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(i,{className:"mr-2 text-primary",size:20}),(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"알림 설정"})]}),(0,r.jsx)("div",{className:"flex justify-center p-4",children:(0,r.jsx)("span",{className:"text-muted-foreground",children:"로딩 중..."})})]}):(0,r.jsxs)("div",{className:"bg-card p-6 rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(i,{className:"mr-2 text-primary",size:20}),(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"알림 설정"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("label",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{children:"이메일 알림"}),(0,r.jsx)("input",{type:"checkbox",checked:t.emailNotifications,onChange:()=>m("emailNotifications")})]}),(0,r.jsxs)("label",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{children:"새 레시피 알림"}),(0,r.jsx)("input",{type:"checkbox",checked:t.newRecipeNotifications,onChange:()=>m("newRecipeNotifications")})]}),(0,r.jsxs)("label",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{children:"마케팅 알림"}),(0,r.jsx)("input",{type:"checkbox",checked:t.marketingNotifications,onChange:()=>m("marketingNotifications")})]}),(0,r.jsxs)("label",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{children:"보안 알림"}),(0,r.jsx)("input",{type:"checkbox",checked:t.securityNotifications,onChange:()=>m("securityNotifications")})]})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("button",{type:"button",className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer",onClick:h,disabled:l,children:l?"저장 중...":"설정 저장"})})]})}},1525:(e,s,t)=>{"use strict";t.d(s,{N:()=>n});var r=t(4057),a=t(4338);let i=a.env.NEXT_PUBLIC_SUPABASE_URL||"",c=a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"";if(!i||!c)throw Error("Supabase URL과 익명 키가 설정되지 않았습니다.");let n=(0,r.createBrowserClient)(i,c)},1758:(e,s,t)=>{"use strict";t.d(s,{default:()=>l});var r=t(4568),a=t(7620),i=t(3385),c=t(9690),n=t(2942),o=t(1874),d=t(4193);function l(e){let{userId:s}=e,[t,l]=(0,a.useState)(!1),[u,m]=(0,a.useState)(""),[h,x]=(0,a.useState)(!1),p=(0,n.useRouter)(),f=async()=>{if("계정삭제"!==u){o.oR.error("확인 텍스트가 일치하지 않습니다");return}x(!0);try{let e=await fetch("/api/users/".concat(s),{method:"DELETE",headers:{"Content-Type":"application/json"}});if(e.ok)o.oR.success("계정이 성공적으로 삭제되었습니다"),await (0,d.CI)(),p.push("/");else{let s=await e.json();o.oR.error(s.error||"계정 삭제 중 오류가 발생했습니다"),x(!1)}}catch(e){console.error("계정 삭제 오류:",e),o.oR.error("서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요"),x(!1)}};return(0,r.jsxs)("div",{className:"bg-destructive/5 p-6 rounded-lg border border-destructive/30",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(i.A,{className:"mr-2 text-destructive",size:20}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-destructive",children:"계정 삭제"})]}),t?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-destructive/10 p-4 rounded-md border border-destructive flex items-start",children:[(0,r.jsx)(c.A,{className:"text-destructive mr-2 flex-shrink-0 mt-0.5",size:16}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-destructive",children:"주의: 이 작업은 취소할 수 없습니다"}),(0,r.jsx)("p",{className:"text-sm mt-1",children:"계정을 삭제하면 모든 데이터가 영구적으로 삭제되며, 복구할 수 없습니다."})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2 text-destructive",children:'확인을 위해 "계정삭제"를 입력하세요'}),(0,r.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),className:"w-full p-3 rounded-md border border-destructive/30 bg-destructive/5",placeholder:"계정삭제"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{type:"button",className:"px-4 py-2 bg-destructive text-destructive-foreground rounded-md hover:bg-destructive/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer",onClick:f,disabled:h||"계정삭제"!==u,children:h?"삭제 중...":"계정 영구 삭제"}),(0,r.jsx)("button",{type:"button",className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-secondary/90 transition-colors cursor-pointer",onClick:()=>{l(!1),m("")},disabled:h,children:"취소"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"text-sm mb-4",children:"계정을 삭제하면 모든 개인정보와 레시피, 활동 내역이 영구적으로 삭제됩니다. 이 작업은 취소할 수 없습니다."}),(0,r.jsx)("button",{type:"button",className:"px-4 py-2 bg-destructive text-destructive-foreground rounded-md hover:bg-destructive/90 transition-colors cursor-pointer",onClick:()=>{l(!0)},children:"계정 삭제"})]})]})}},2347:(e,s,t)=>{"use strict";t.d(s,{default:()=>x});var r=t(4568),a=t(7620),i=t(8889);let c=(0,i.A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),n=(0,i.A)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),o=(0,i.A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var d=t(1938),l=t(60),u=t(880),m=t(1874);let h=u.z.object({currentPassword:u.z.string().min(1,"현재 비밀번호를 입력해주세요"),newPassword:u.z.string().min(8,"비밀번호는 최소 8자 이상이어야 합니다").regex(/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[!@#$%^&*()_+])[A-Za-z\d!@#$%^&*()_+]{8,}$/,"비밀번호는 영문, 숫자, 특수문자를 포함해야 합니다"),confirmPassword:u.z.string().min(1,"비밀번호 확인을 입력해주세요")}).refine(e=>e.newPassword===e.confirmPassword,{message:"새 비밀번호와 확인 비밀번호가 일치하지 않습니다",path:["confirmPassword"]});function x(e){let{userId:s,userEmail:t}=e,[i,u]=(0,a.useState)(!1),[x,p]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1),[y,w]=(0,a.useState)(!1),{register:j,handleSubmit:N,reset:v,formState:{errors:g}}=(0,d.mN)({resolver:(0,l.u)(h)}),k=async e=>{w(!0);try{let t=await fetch("/api/auth/password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s,currentPassword:e.currentPassword,newPassword:e.newPassword})}),r=await t.json();t.ok?(m.oR.success("비밀번호가 성공적으로 변경되었습니다"),v()):m.oR.error(r.error||"비밀번호 변경 중 오류가 발생했습니다")}catch(e){m.oR.error("서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요"),console.error("비밀번호 변경 오류:",e)}finally{w(!1)}};return(0,r.jsxs)("div",{className:"bg-card p-6 rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(c,{className:"mr-2 text-primary",size:20}),(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"비밀번호 변경"})]}),(0,r.jsxs)("form",{className:"space-y-4",onSubmit:N(k),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium mb-2",children:"현재 비밀번호"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:i?"text":"password",id:"currentPassword",...j("currentPassword"),className:"w-full p-3 rounded-md border border-input bg-background pr-10"}),(0,r.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground cursor-pointer",onClick:()=>u(!i),children:i?(0,r.jsx)(n,{size:18}):(0,r.jsx)(o,{size:18})})]}),g.currentPassword&&(0,r.jsx)("p",{className:"text-destructive text-xs mt-1",children:g.currentPassword.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium mb-2",children:"새 비밀번호"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:x?"text":"password",id:"newPassword",...j("newPassword"),className:"w-full p-3 rounded-md border border-input bg-background pr-10"}),(0,r.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground cursor-pointer",onClick:()=>p(!x),children:x?(0,r.jsx)(n,{size:18}):(0,r.jsx)(o,{size:18})})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"비밀번호는 최소 8자 이상, 영문/숫자/특수문자를 포함해야 합니다."}),g.newPassword&&(0,r.jsx)("p",{className:"text-destructive text-xs mt-1",children:g.newPassword.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium mb-2",children:"새 비밀번호 확인"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:f?"text":"password",id:"confirmPassword",...j("confirmPassword"),className:"w-full p-3 rounded-md border border-input bg-background pr-10"}),(0,r.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground cursor-pointer",onClick:()=>b(!f),children:f?(0,r.jsx)(n,{size:18}):(0,r.jsx)(o,{size:18})})]}),g.confirmPassword&&(0,r.jsx)("p",{className:"text-destructive text-xs mt-1",children:g.confirmPassword.message})]}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)("button",{type:"submit",disabled:y,className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer",children:y?"변경 중...":"비밀번호 변경"})})]})]})}},3385:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(8889).A)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]])},4193:(e,s,t)=>{"use strict";t.d(s,{Bh:()=>o,CI:()=>n,Ru:()=>i,bk:()=>a,cU:()=>c});var r=t(1525);async function a(e,s){let{data:t,error:a}=await r.N.auth.signUp({email:e,password:s});if(a)throw a;return t}async function i(e,s){let{data:t,error:a}=await r.N.auth.signInWithPassword({email:e,password:s});if(a)return a.message.includes("Invalid login credentials")?{success:!1,error:"이메일 또는 비밀번호가 올바르지 않습니다."}:a.message.includes("Email not confirmed")?{success:!1,error:"이메일 인증이 완료되지 않았습니다. 메일함을 확인해주세요."}:a.message.includes("rate limit")?{success:!1,error:"로그인 시도가 너무 많습니다. 잠시 후 다시 시도해주세요."}:{success:!1,error:"로그인 중 오류가 발생했습니다: "+a.message};return{success:!0,data:t}}async function c(e){let{data:s,error:t}=await r.N.auth.signInWithOAuth({provider:e,options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});return t?t.message.includes("popup blocked")?{success:!1,error:"팝업이 차단되었습니다. 팝업 차단을 해제해주세요."}:t.message.includes("canceled")?{success:!1,error:"로그인이 취소되었습니다."}:{success:!1,error:"".concat(e," 로그인 중 오류가 발생했습니다: ")+t.message}:{success:!0,data:s}}async function n(){let{error:e}=await r.N.auth.signOut();if(e)throw e}function o(e){return r.N.auth.onAuthStateChange((s,t)=>{e((null==t?void 0:t.user)||null)})}},8296:(e,s,t)=>{Promise.resolve().then(t.bind(t,1758)),Promise.resolve().then(t.bind(t,1254)),Promise.resolve().then(t.bind(t,2347)),Promise.resolve().then(t.t.bind(t,7261,23))},8889:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var r=t(7620);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter((e,s,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim()};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,r.forwardRef)((e,s)=>{let{color:t="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:d="",children:l,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:s,...c,width:a,height:a,stroke:t,strokeWidth:o?24*Number(n)/Number(a):n,className:i("lucide",d),...m},[...u.map(e=>{let[s,t]=e;return(0,r.createElement)(s,t)}),...Array.isArray(l)?l:[l]])}),o=(e,s)=>{let t=(0,r.forwardRef)((t,c)=>{let{className:o,...d}=t;return(0,r.createElement)(n,{ref:c,iconNode:s,className:i("lucide-".concat(a(e)),o),...d})});return t.displayName="".concat(e),t}},9690:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(8889).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[7261,4239,1874,4057,587,8315,7358],()=>s(8296)),_N_E=e.O()}]);