(()=>{var e={};e.id=5663,e.ids=[5663],e.modules={2329:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"0097f32c3c6834504afc7f51568955b58358dafa87":()=>n.v6,"00fa2d22aa2f0d457ac8459aed2f66c89232351aae":()=>n.Kx,"4039b3fc82c7cae0300ca48d4319cafd00ddc15042":()=>n.rr,"405333280afb49bd5ebeef282575f6f93f24589c34":()=>i.G,"4057da01a1dedce3831aa62d6027cb70fc05ab7149":()=>n.sm,"4063dc433687fb1ab011722b26b8d484a075215405":()=>i.qt,"40881af8245ace9d7983511a91a5b37676d13fca1e":()=>n.DS,"4092f0d1ee2e78dba22d09bcc75a9574c3492e6295":()=>n.yA,"40bb057f7efcb39c01b4b2de998e3babc3c4b12557":()=>i.dU,"609040d7801287eee927927e2a7433f58bda2cc5a0":()=>n.zH,"60b74c88484bc97542423700fc9442ff98cfdb30c8":()=>n.pe,"60d74d0be3c3bb8c15ff4a2ac4bd90336ad6b21541":()=>i.cX,"708d2101345b6641f648d5022e57c057d8d2b59f86":()=>i.zs,"78caecb7db732db0fd8ce5a41ac82f47dfb73afe07":()=>i.sw});var i=t(20483),n=t(63327)},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},17626:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>s.default,__next_app__:()=>l,pages:()=>d,routeModule:()=>p,tree:()=>c});var i=t(24332),n=t(48819),s=t(84423),a=t(97540),o={};for(let e in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>a[e]);t.d(r,o);let c={children:["",{children:["recipes",{children:["create",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,57681)),"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/recipes/create/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,9699))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,5910)),"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,80765)),"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/error.tsx"],"global-error":[()=>Promise.resolve().then(t.bind(t,84423)),"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/global-error.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,92341,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,9699))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/recipes/create/page.tsx"],l={require:t,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/recipes/create/page",pathname:"/recipes/create",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20483:(e,r,t)=>{"use strict";t.d(r,{zs:()=>u,cX:()=>m,dU:()=>b,qt:()=>f,G:()=>h,sw:()=>g});var i=t(3742);t(93200);var n=t(24479),s=t(93500),a=t(91728),o=t(27785),c=t(36619),d=t(77256);async function l(){let e=(0,o.UL)(),r=(0,c.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{get:r=>e.get(r)?.value}}),{data:{user:t}}=await r.auth.getUser();return t?.id||null}(0,d.D)([l]),(0,i.A)(l,"00395df8f493ec72727eb10563087fdf81a261e68d",null);let p=a.z.object({title:a.z.string().min(1,"레시피 이름은 필수입니다"),brewingMethod:a.z.string().min(1,"추출 방식은 필수입니다"),difficulty:a.z.string().optional(),preparationTime:a.z.string().min(1,"소요 시간은 필수입니다"),beanAmount:a.z.string().min(1,"원두량은 필수입니다"),waterAmount:a.z.string().min(1,"물 용량은 필수입니다"),waterTemp:a.z.string().optional(),grindSize:a.z.string().min(1,"분쇄도는 필수입니다"),tools:a.z.string().optional(),acidity:a.z.string().optional(),sweetness:a.z.string().optional(),body:a.z.string().optional(),recommendedBeans:a.z.string().optional(),description:a.z.string().optional(),notes:a.z.string().optional(),steps:a.z.string().optional(),isPublic:a.z.boolean().default(!0),beanId:a.z.string().optional().nullable(),grinderId:a.z.string().optional().nullable(),grinderSetting:a.z.string().optional().nullable()});async function u(e,r,t){let i=await l();if(!i)return{errors:{_form:["로그인이 필요합니다."]}};let a=p.safeParse({title:t.get("title"),description:t.get("description"),brewingMethod:t.get("method"),difficulty:t.get("difficulty"),preparationTime:t.get("preparationTime"),beanAmount:t.get("beanAmount"),waterAmount:t.get("waterAmount"),waterTemp:t.get("waterTemp")||t.get("temperature"),grindSize:t.get("grindSize"),tools:t.get("equipment"),acidity:t.get("acidity")||"중간",sweetness:t.get("sweetness")||"중간",body:t.get("body")||"중간",recommendedBeans:t.get("recommendedBeans")||"",isPublic:"true"===t.get("isPublic"),beanId:t.get("beanId")||null,grinderId:t.get("grinderId")||null,grinderSetting:t.get("grinderSetting")||null});if(!a.success)return{errors:a.error.flatten().fieldErrors,message:"입력 정보를 확인해주세요."};let{title:o,description:c,brewingMethod:d,difficulty:u,preparationTime:f,beanAmount:b,waterAmount:g,waterTemp:m,grindSize:h,tools:w,acidity:y,sweetness:x,body:v,recommendedBeans:z,isPublic:P,beanId:A,grinderId:I,grinderSetting:j}=a.data;try{let e=parseInt(t.get("stepsCount")?.toString()||"0",10),r=[];if(e>0){for(let i=0;i<e;i++){let e=t.get(`step-${i}`)?.toString();e?.trim()&&r.push(e)}r.join("\n")}let a=await s.zR.recipe.create({data:{title:o,description:c,brewingMethod:d,difficulty:u,preparationTime:f,beanAmount:b,waterAmount:g,waterTemp:m,grindSize:h,tools:w,acidity:y,sweetness:x,body:v,recommendedBeans:z,steps:{create:r.map((e,r)=>({order:r+1,description:e}))},isPublic:P,userId:i,grinderId:I,grinderSetting:j,beanId:A||void 0}}),l=t.get("ingredients");if(l)for(let e of l.split(",").map(e=>e.trim()))await s.zR.ingredient.create({data:{name:e,recipeId:a.id}});let p=t.get("brewingTips");if(p)for(let e of p.split("\n").filter(e=>""!==e.trim()))await s.zR.brewingTip.create({data:{content:e.trim(),recipeId:a.id}});return(0,n.revalidatePath)("/recipes"),{message:"레시피가 성공적으로 생성되었습니다."}}catch(e){return console.error("레시피 생성 오류:",e),{errors:{_form:["레시피 생성 중 오류가 발생했습니다. 다시 시도해주세요."]}}}}async function f(e){try{let r={isPublic:!0};return e&&(r={...r,brewingMethod:e}),await s.zR.recipe.findMany({where:r,select:{id:!0,title:!0,description:!0,preparationTime:!0,beanAmount:!0,waterAmount:!0,difficulty:!0,grindSize:!0,brewingMethod:!0,isPublic:!0,createdAt:!0,updatedAt:!0},orderBy:{createdAt:"desc"}})}catch(e){if(console.error("레시피 조회 오류:",e),e instanceof Error&&(e.message.includes("P5010")||e.message.includes("fetch failed")))throw Error("데이터베이스 연결에 실패했습니다. 네트워크 연결을 확인하거나 잠시 후 다시 시도해주세요.");throw Error("레시피를 불러오는 중 오류가 발생했습니다.")}}async function b(e){try{return await s.zR.recipe.findUnique({where:{id:e},include:{ingredients:!0,steps:{orderBy:{order:"asc"}},brewingTips:!0,user:{select:{id:!0,name:!0,image:!0}}}})}catch(e){throw console.error("레시피 상세 조회 오류:",e),Error("레시피를 불러오는 중 오류가 발생했습니다.")}}async function g(e,r,t,i){let a=await l();if(!a)return{errors:{_form:["로그인이 필요합니다."]}};let o=await s.zR.recipe.findUnique({where:{id:e}});if(!o)return{errors:{_form:["존재하지 않는 레시피입니다."]}};if(o.userId!==a)return{errors:{_form:["본인이 작성한 레시피만 수정할 수 있습니다."]}};let c=p.safeParse({title:i.get("title"),description:i.get("description"),brewingMethod:i.get("method")||i.get("brewingMethod"),difficulty:i.get("difficulty"),preparationTime:i.get("preparationTime"),beanAmount:i.get("beanAmount"),waterAmount:i.get("waterAmount"),waterTemp:i.get("waterTemp")||i.get("temperature"),grindSize:i.get("grindSize"),tools:i.get("equipment")||i.get("tools"),acidity:i.get("acidity")||"중간",sweetness:i.get("sweetness")||"중간",body:i.get("body")||"중간",recommendedBeans:i.get("recommendedBeans")||"",isPublic:"true"===i.get("isPublic"),beanId:i.get("beanId")||null,grinderId:i.get("grinderId")||null,grinderSetting:i.get("grinderSetting")||null});if(!c.success)return{errors:c.error.flatten().fieldErrors,message:"입력 정보를 확인해주세요."};let{title:d,description:u,brewingMethod:f,difficulty:b,preparationTime:g,beanAmount:m,waterAmount:h,waterTemp:w,grindSize:y,tools:x,acidity:v,sweetness:z,body:P,recommendedBeans:A,isPublic:I,beanId:j,grinderId:_,grinderSetting:q}=c.data;try{let r="",t=parseInt(i.get("stepsCount")?.toString()||"0",10);if(t>0){let e=[];for(let r=0;r<t;r++){let t=i.get(`step-${r}`)?.toString();t?.trim()&&e.push(t)}r=e.join("\n")}await s.zR.recipe.update({where:{id:e},data:{title:d,description:u,brewingMethod:f,difficulty:b,preparationTime:g,beanAmount:m,waterAmount:h,waterTemp:w,grindSize:y,tools:x,acidity:v,sweetness:z,body:P,recommendedBeans:A,steps:r,isPublic:I,grinderId:_,grinderSetting:q,beanId:j||void 0}}),await s.zR.ingredient.deleteMany({where:{recipeId:e}});let a=i.get("ingredients");if(a)for(let r of a.split(",").map(e=>e.trim()))await s.zR.ingredient.create({data:{name:r,recipeId:e}});await s.zR.brewingTip.deleteMany({where:{recipeId:e}});let o=i.get("brewingTips");if(o)for(let r of o.split("\n").filter(e=>""!==e.trim()))await s.zR.brewingTip.create({data:{content:r.trim(),recipeId:e}});return(0,n.revalidatePath)("/recipes"),(0,n.revalidatePath)(`/recipes/${e}`),{message:"레시피가 성공적으로 업데이트되었습니다."}}catch(e){return console.error("레시피 업데이트 오류:",e),{errors:{_form:["레시피 업데이트 중 오류가 발생했습니다. 다시 시도해주세요."]}}}}async function m(e,r){try{let r=await l();if(!r)throw Error("로그인이 필요합니다.");let t=await s.zR.recipe.findUnique({where:{id:e}});if(!t)throw Error("존재하지 않는 레시피입니다.");let i=process.env.NEXT_PUBLIC_ADMIN_EMAIL===r;if(t.userId!==r&&!i)throw Error("본인이 작성한 레시피만 삭제할 수 있습니다.");return await s.zR.$transaction([s.zR.ingredient.deleteMany({where:{recipeId:e}}),s.zR.brewingTip.deleteMany({where:{recipeId:e}}),s.zR.recipe.delete({where:{id:e}})]),(0,n.revalidatePath)("/recipes"),{success:!0,message:"레시피가 성공적으로 삭제되었습니다."}}catch(e){return console.error("레시피 삭제 오류:",e),{success:!1,message:"레시피 삭제 중 오류가 발생했습니다."}}}async function h(e){try{return await s.zR.recipe.findMany({where:{userId:e},include:{ingredients:!0,steps:{orderBy:{order:"asc"}},brewingTips:!0},orderBy:{createdAt:"desc"}})}catch(e){return console.error("작성자별 레시피 조회 오류:",e),[]}}(0,d.D)([u,f,b,g,m,h]),(0,i.A)(u,"708d2101345b6641f648d5022e57c057d8d2b59f86",null),(0,i.A)(f,"4063dc433687fb1ab011722b26b8d484a075215405",null),(0,i.A)(b,"40bb057f7efcb39c01b4b2de998e3babc3c4b12557",null),(0,i.A)(g,"78caecb7db732db0fd8ce5a41ac82f47dfb73afe07",null),(0,i.A)(m,"60d74d0be3c3bb8c15ff4a2ac4bd90336ad6b21541",null),(0,i.A)(h,"405333280afb49bd5ebeef282575f6f93f24589c34",null)},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},49641:(e,r,t)=>{"use strict";t.d(r,{CreateRecipeContent:()=>i});let i=(0,t(33952).registerClientReference)(function(){throw Error("Attempted to call CreateRecipeContent() from the server but CreateRecipeContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/recipes/create/create-recipe-content.tsx","CreateRecipeContent")},52263:(e,r,t)=>{Promise.resolve().then(t.bind(t,49641))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57681:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a,metadata:()=>s});var i=t(38828);t(61365);var n=t(49641);let s={title:"초코야 커피 - 레시피 작성",description:"나만의 커피 브루잉 레시피를 작성하고 공유하세요"};function a(){return(0,i.jsx)(n.CreateRecipeContent,{})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66175:(e,r,t)=>{Promise.resolve().then(t.bind(t,67844))},67844:(e,r,t)=>{"use strict";t.d(r,{CreateRecipeContent:()=>d});var i=t(13486);t(60159);var n=t(49989),s=t.n(n);let a=(0,t(84667).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var o=t(58499),c=t(45027);function d(){return(0,i.jsxs)("div",{className:"container px-4 md:px-6 py-6 md:py-10",children:[(0,i.jsxs)(s(),{href:"/recipes",className:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground mb-4 md:mb-6",children:[(0,i.jsx)(a,{size:16,className:"mr-1"})," 레시피 목록으로 돌아가기"]}),(0,i.jsxs)("h1",{className:"text-2xl md:text-3xl font-bold mb-4 md:mb-6 flex items-center",children:[(0,i.jsx)(o.A,{className:"mr-2"})," 새 레시피 작성하기"]}),(0,i.jsx)("div",{className:"mb-6",children:(0,i.jsx)("p",{className:"text-muted-foreground",children:"나만의 커피 브루잉 레시피를 작성하고 커뮤니티와 공유해보세요. 상세한 정보를 제공할수록 다른 사용자들에게 도움이 됩니다."})}),(0,i.jsx)("div",{className:"bg-card border rounded-lg p-4 md:p-6 lg:p-8",children:(0,i.jsx)(c.default,{})})]})}},74075:e=>{"use strict";e.exports=require("zlib")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96330:e=>{"use strict";e.exports=require("@prisma/client")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[191,3395,5208,3796,4058,1253,8655,1728,1991,2808,856,5361,5027],()=>t(17626));module.exports=i})();