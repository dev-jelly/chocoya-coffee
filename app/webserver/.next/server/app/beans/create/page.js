"use strict";(()=>{var e={};e.id=5127,e.ids=[5127],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{e.exports=require("punycode")},19121:e=>{e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21913:(e,r,t)=>{t.r(r),t.d(r,{"400f848ca9c3d3c5e2201c08bc803edee6521b5888":()=>a.NH,"4035cbe8ce0687cf0aad1bc64c9fe95bf4ef4b66df":()=>a.JQ,"40dd756df4f8233e05d1907947a699d86659ad0e72":()=>a.y7,"60f44d3f410dbeca9194c741272be48515606c7c1d":()=>a.IV,"7094e3ba894d8125ad170d6181026c57ac27925c57":()=>a.JV,"7814bbd4645cf52ef71e339537b3bdfc20cb9aed38":()=>a.wI});var a=t(84880)},27910:e=>{e.exports=require("stream")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},34631:e=>{e.exports=require("tls")},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66501:(e,r,t)=>{t.r(r),t.d(r,{default:()=>p,metadata:()=>u});var a=t(38828);t(61365);var s=t(42671),o=t.n(s),n=t(78443),i=t(78631),l=t(42543),c=t(63550),d=t(84875);let u={title:"원두 정보 등록 | 초코야 커피",description:"나만의 원두 정보를 등록하고 관리하세요"};async function p(){let e=await (0,d.U)(),{data:{user:r}}=await e.auth.getUser();return r?.id||(0,l.redirect)("/auth/login?callbackUrl=/beans/create"),(0,a.jsxs)("div",{className:"container mx-auto py-10",children:[(0,a.jsxs)(o(),{href:"/beans",className:"text-primary hover:underline flex items-center mb-6",children:[(0,a.jsx)(n.A,{className:"mr-2",size:16}),"원두 목록으로 돌아가기"]}),(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,a.jsxs)("h1",{className:"text-3xl font-bold flex items-center",children:[(0,a.jsx)(i.A,{className:"mr-2"}),"원두 정보 등록하기"]})}),(0,a.jsx)("div",{className:"bg-card p-6 rounded-lg shadow-md mb-6",children:(0,a.jsx)(c.default,{userId:r.id})})]})]})}},74075:e=>{e.exports=require("zlib")},79428:e=>{e.exports=require("buffer")},79551:e=>{e.exports=require("url")},81630:e=>{e.exports=require("http")},84880:(e,r,t)=>{t.d(r,{IV:()=>b,JQ:()=>p,JV:()=>c,NH:()=>u,wI:()=>f,y7:()=>d});var a=t(3742);t(93200);var s=t(24479),o=t(93500),n=t(91728),i=t(77256);let l=n.z.object({name:n.z.string().min(1,"원두 이름은 필수입니다"),origin:n.z.string().optional(),region:n.z.string().optional(),farm:n.z.string().optional(),altitude:n.z.string().optional(),process:n.z.string().optional(),variety:n.z.string().optional(),roastLevel:n.z.string().optional(),roaster:n.z.string().optional(),description:n.z.string().optional(),isPublic:n.z.boolean().default(!0),flavorNotes:n.z.string().optional(),flavorLabels:n.z.string().optional(),flavorColors:n.z.string().optional(),primaryColor:n.z.string().optional()});async function c(e,r,t){let a=l.safeParse({name:t.get("name"),origin:t.get("origin"),region:t.get("region"),farm:t.get("farm"),altitude:t.get("altitude"),process:t.get("process"),variety:t.get("variety"),roastLevel:t.get("roastLevel"),roaster:t.get("roaster"),description:t.get("description"),isPublic:"true"===t.get("isPublic"),flavorNotes:t.get("flavorNotes"),flavorLabels:t.get("flavorLabels"),flavorColors:t.get("flavorColors"),primaryColor:t.get("primaryColor")});if(!a.success)return{errors:a.error.flatten().fieldErrors,message:"입력 정보를 확인해주세요."};let{name:n,origin:i,region:c,farm:d,altitude:u,process:p,variety:f,roastLevel:b,roaster:m,description:g,isPublic:v,flavorNotes:x,flavorLabels:h,flavorColors:y,primaryColor:w}=a.data;try{return await o.zR.bean.create({data:{name:n,origin:i,region:c,farm:d,altitude:u,process:p,variety:f,roastLevel:b,roaster:m,description:g,isPublic:v,flavorNotes:x,flavorLabels:h,flavorColors:y,primaryColor:w,userId:e}}),(0,s.revalidatePath)("/beans"),{message:"원두 정보가 성공적으로 등록되었습니다."}}catch(e){return console.error("원두 등록 오류:",e),{errors:{_form:["원두 등록 중 오류가 발생했습니다. 다시 시도해주세요."]}}}}async function d(e){try{return await o.zR.bean.findMany({where:{isPublic:!0,...e?{OR:[{name:{contains:e}},{origin:{contains:e}},{roaster:{contains:e}}]}:{}},include:{user:{select:{name:!0}}},orderBy:{createdAt:"desc"}})}catch(e){return console.error("원두 목록 조회 오류:",e),[]}}async function u(e){try{return await o.zR.bean.findMany({where:{userId:e},orderBy:{createdAt:"desc"}})}catch(e){return console.error("사용자 원두 목록 조회 오류:",e),[]}}async function p(e){try{return await o.zR.bean.findUnique({where:{id:e},include:{user:{select:{name:!0}},recipes:{include:{user:{select:{name:!0}}},orderBy:{createdAt:"desc"},take:5},tasteNotes:{include:{user:{select:{name:!0}}},orderBy:{createdAt:"desc"},take:5}}})}catch(e){return console.error("원두 상세 조회 오류:",e),null}}async function f(e,r,t,a){let n=l.safeParse({name:a.get("name"),origin:a.get("origin"),region:a.get("region"),farm:a.get("farm"),altitude:a.get("altitude"),process:a.get("process"),variety:a.get("variety"),roastLevel:a.get("roastLevel"),roaster:a.get("roaster"),description:a.get("description"),isPublic:"true"===a.get("isPublic"),flavorNotes:a.get("flavorNotes"),flavorLabels:a.get("flavorLabels"),flavorColors:a.get("flavorColors"),primaryColor:a.get("primaryColor")});if(!n.success)return{errors:n.error.flatten().fieldErrors,message:"입력 정보를 확인해주세요."};let i=await o.zR.bean.findUnique({where:{id:e},select:{userId:!0}});if(!i||i.userId!==r)return{errors:{_form:["원두 정보를 수정할 권한이 없습니다."]}};let{name:c,origin:d,region:u,farm:p,altitude:f,process:b,variety:m,roastLevel:g,roaster:v,description:x,isPublic:h,flavorNotes:y,flavorLabels:w,flavorColors:P,primaryColor:z}=n.data;try{return await o.zR.bean.update({where:{id:e},data:{name:c,origin:d,region:u,farm:p,altitude:f,process:b,variety:m,roastLevel:g,roaster:v,description:x,isPublic:h,flavorNotes:y,flavorLabels:w,flavorColors:P,primaryColor:z}}),(0,s.revalidatePath)(`/beans/${e}`),{message:"원두 정보가 성공적으로 수정되었습니다."}}catch(e){return console.error("원두 수정 오류:",e),{errors:{_form:["원두 수정 중 오류가 발생했습니다. 다시 시도해주세요."]}}}}async function b(e,r){try{let t=await o.zR.bean.findUnique({where:{id:e},select:{userId:!0}});if(!t||t.userId!==r)return{success:!1,message:"원두 정보를 삭제할 권한이 없습니다."};return await o.zR.bean.delete({where:{id:e}}),(0,s.revalidatePath)("/beans"),{success:!0,message:"원두 정보가 성공적으로 삭제되었습니다."}}catch(e){return console.error("원두 삭제 오류:",e),{success:!1,message:"원두 삭제 중 오류가 발생했습니다. 다시 시도해주세요."}}}(0,i.D)([c,d,u,p,f,b]),(0,a.A)(c,"7094e3ba894d8125ad170d6181026c57ac27925c57",null),(0,a.A)(d,"40dd756df4f8233e05d1907947a699d86659ad0e72",null),(0,a.A)(u,"400f848ca9c3d3c5e2201c08bc803edee6521b5888",null),(0,a.A)(p,"4035cbe8ce0687cf0aad1bc64c9fe95bf4ef4b66df",null),(0,a.A)(f,"7814bbd4645cf52ef71e339537b3bdfc20cb9aed38",null),(0,a.A)(b,"60f44d3f410dbeca9194c741272be48515606c7c1d",null)},87138:(e,r,t)=>{t.r(r),t.d(r,{GlobalError:()=>o.default,__next_app__:()=>d,pages:()=>c,routeModule:()=>u,tree:()=>l});var a=t(24332),s=t(48819),o=t(84423),n=t(97540),i={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);t.d(r,i);let l={children:["",{children:["beans",{children:["create",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,66501)),"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/beans/create/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,9699))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,5910)),"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,80765)),"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/error.tsx"],"global-error":[()=>Promise.resolve().then(t.bind(t,84423)),"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/global-error.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,92341,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,9699))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/beans/create/page.tsx"],d={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/beans/create/page",pathname:"/beans/create",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},91645:e=>{e.exports=require("net")},93500:(e,r,t)=>{t.d(r,{zR:()=>o});var a=t(96330);let s=global;s.isConnected||(s.isConnected=!1,s.connectionError=null,s.lastConnectionAttempt=0,s.connectionRetryCount=0);let o=s.prisma??function(){let e=process.env.DATABASE_URL;process.env.DIRECT_URL;let r={log:["error"],errorFormat:"pretty"};return e&&(r.datasources={db:{url:e}}),new a.PrismaClient(r)}()},94735:e=>{e.exports=require("events")},96330:e=>{e.exports=require("@prisma/client")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[191,3395,5208,3796,4058,1253,8655,1728,7102,856,4179,8461],()=>t(87138));module.exports=a})();