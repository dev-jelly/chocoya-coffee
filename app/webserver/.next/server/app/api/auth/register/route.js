(()=>{var e={};e.id=1612,e.ids=[1612],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},42341:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>h,routeModule:()=>m,serverHooks:()=>x,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>f});var n={};t.r(n),t.d(n,{POST:()=>d});var s=t(48106),o=t(48819),a=t(12050),i=t(4235),c=t(44627),u=t(1610),l=t(16151);let p=l.z.object({name:l.z.string().min(2,{message:"이름은 2자 이상이어야 합니다."}),email:l.z.string().email({message:"유효한 이메일 주소를 입력해주세요."}),password:l.z.string().min(8,{message:"비밀번호는 8자 이상이어야 합니다."})});async function d(e){try{let r=await e.json(),t=p.safeParse(r);if(!t.success)return i.NextResponse.json({success:!1,error:"유효하지 않은 입력입니다.",issues:t.error.flatten().fieldErrors},{status:400});let{name:n,email:s,password:o}=t.data;if(await c.zR.user.findUnique({where:{email:s}}))return console.log(`회원가입 충돌: 이메일 '${s}'은 이미 사용 중입니다.`),i.NextResponse.json({success:!1,error:"이미 등록된 이메일입니다."},{status:409});let a=await u.Ay.hash(o,10),{password:l,...d}=await c.zR.user.create({data:{name:n,email:s,password:a}});return i.NextResponse.json({success:!0,message:"회원가입이 완료되었습니다.",user:d})}catch(e){return console.error("회원가입 오류:",e.message||e),i.NextResponse.json({success:!1,error:"회원가입 처리 중 오류가 발생했습니다.",details:void 0},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/api/auth/register/route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:g,workUnitAsyncStorage:f,serverHooks:x}=m;function h(){return(0,a.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:f})}},44627:(e,r,t)=>{"use strict";t.d(r,{kR:()=>i,zR:()=>o});var n=t(96330);let s=global;s.isConnected||(s.isConnected=!1,s.connectionError=null,s.lastConnectionAttempt=0,s.connectionRetryCount=0);let o=s.prisma??function(){let e=process.env.DATABASE_URL;process.env.DIRECT_URL;let r={log:["error"],errorFormat:"pretty"};return e&&(r.datasources={db:{url:e}}),new n.PrismaClient(r)}();async function a(){try{let e=Date.now();if(s.isConnected)return{connected:!0,error:null};if(s.connectionError&&e-s.lastConnectionAttempt<3e4)return{connected:!1,error:s.connectionError};if(s.connectionRetryCount>=3){let r=e-s.lastConnectionAttempt;if(r<3e4)return{connected:!1,error:`${s.connectionError} (${Math.ceil((3e4-r)/1e3)}초 후 재시도 가능)`};s.connectionRetryCount=0}return s.lastConnectionAttempt=e,s.connectionRetryCount++,await o.user.findFirst({select:{id:!0},take:1}),s.isConnected=!0,s.connectionError=null,s.connectionRetryCount=0,{connected:!0,error:null}}catch(r){console.error("Database connection error:",r);let e="데이터베이스 연결 오류";return r instanceof Error&&(r.message.includes("P5010")||r.message.includes("fetch failed")?e="데이터베이스 서버에 연결할 수 없습니다. 네트워크 연결을 확인하거나 잠시 후 다시 시도해주세요.":r.message.includes("timeout")?e="데이터베이스 연결 시간이 초과되었습니다. 잠시 후 다시 시도해주세요.":r.message.includes("authentication")&&(e="데이터베이스 인증에 실패했습니다. 관리자에게 문의하세요.")),s.isConnected=!1,s.connectionError=e,{connected:!1,error:e}}}async function i(e,r,t){try{let n=await a();if(!n.connected)return t&&t(Error(n.error||"데이터베이스 연결 오류")),r;return await e()}catch(e){return console.error("Database operation error:",e),t&&t(e),r}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},80408:()=>{},87032:()=>{},96330:e=>{"use strict";e.exports=require("@prisma/client")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[191,3744,6151,1610],()=>t(42341));module.exports=n})();