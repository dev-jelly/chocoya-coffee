(()=>{var e={};e.id=1036,e.ids=[1036],e.modules={2502:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"0097f32c3c6834504afc7f51568955b58358dafa87":()=>n.v6,"00fa2d22aa2f0d457ac8459aed2f66c89232351aae":()=>n.Kx,"4039b3fc82c7cae0300ca48d4319cafd00ddc15042":()=>n.rr,"4057da01a1dedce3831aa62d6027cb70fc05ab7149":()=>n.sm,"40881af8245ace9d7983511a91a5b37676d13fca1e":()=>n.DS,"4092f0d1ee2e78dba22d09bcc75a9574c3492e6295":()=>n.yA,"609040d7801287eee927927e2a7433f58bda2cc5a0":()=>n.zH,"60b74c88484bc97542423700fc9442ff98cfdb30c8":()=>n.pe});var n=t(36896)},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4773:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{normalizeAppPath:function(){return a},normalizeRscURL:function(){return s}});let n=t(7004),i=t(43566);function a(e){return(0,n.ensureLeadingSlash)(e.split("/").reduce((e,r,t,n)=>!r||(0,i.isGroupSegment)(r)||"@"===r[0]||("page"===r||"route"===r)&&t===n.length-1?e:e+"/"+r,""))}function s(e){return e.replace(/\.rsc($|\?)/,"$1")}},7004:(e,r)=>{"use strict";function t(e){return e.startsWith("/")?e:"/"+e}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ensureLeadingSlash",{enumerable:!0,get:function(){return t}})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},36896:(e,r,t)=>{"use strict";t.d(r,{DS:()=>l,Kx:()=>f,pe:()=>p,rr:()=>o,sm:()=>u,v6:()=>g,yA:()=>c,zH:()=>d});var n=t(10841);t(10935);var i=t(44627),a=t(30194),s=t(34078);async function o(e){try{let r={};return e&&(r={OR:[{name:{contains:e,mode:"insensitive"}},{name_ko:{contains:e,mode:"insensitive"}},{brand:{contains:e,mode:"insensitive"}},{type:{contains:e,mode:"insensitive"}},{description:{contains:e,mode:"insensitive"}},{description_ko:{contains:e,mode:"insensitive"}}]}),(await i.zR.grinder.findMany({where:r,include:{_count:{select:{settings:!0}}},orderBy:{brand:"asc"}})).map(e=>({...e,settings:[],settingsCount:e._count.settings}))}catch(e){return console.error("Error fetching grinders:",e),[]}}async function c(e){try{return await i.zR.grinder.findUnique({where:{id:e},include:{settings:!0,recipes:{include:{user:{select:{name:!0,image:!0}}},take:5,orderBy:{createdAt:"desc"}}}})}catch(e){return console.error("Error fetching grinder:",e),null}}async function u(e){try{let{settings:r,...t}=e,n=await i.zR.grinder.create({data:{...t,settings:{create:r||[]}}});return(0,a.revalidatePath)("/grinders"),{success:!0,data:n}}catch(e){return console.error("Error creating grinder:",e),{success:!1,error:"Failed to create grinder"}}}async function d(e,r){try{let{settings:t,...n}=r;t&&await i.zR.grinderSetting.deleteMany({where:{grinderId:e}});let s=await i.zR.grinder.update({where:{id:e},data:{...n,...t&&{settings:{create:t}}}});return(0,a.revalidatePath)(`/grinders/${e}`),(0,a.revalidatePath)("/grinders"),{success:!0,data:s}}catch(e){return console.error("Error updating grinder:",e),{success:!1,error:"Failed to update grinder"}}}async function l(e){try{return await i.zR.grinder.delete({where:{id:e}}),(0,a.revalidatePath)("/grinders"),{success:!0}}catch(e){return console.error("Error deleting grinder:",e),{success:!1,error:"Failed to delete grinder"}}}async function p(e,r){try{return await i.zR.grinderSetting.findMany({where:{grinderId:e,brewingMethod:{contains:r,mode:"insensitive"}}})}catch(e){return console.error("Error fetching grinder settings:",e),[]}}async function f(){try{for(let e of s.vu){let{settings:r,...t}=e,n=await i.zR.grinder.findFirst({where:{name:t.name,brand:t.brand}});if(n)for(let e of(await i.zR.grinder.update({where:{id:n.id},data:{name_ko:t.name_ko,description_ko:t.description_ko}}),r)){let r=await i.zR.grinderSetting.findFirst({where:{grinderId:n.id,name:e.name}});r&&await i.zR.grinderSetting.update({where:{id:r.id},data:{name_ko:e.name_ko,description_ko:e.description_ko}})}else await i.zR.grinder.create({data:{id:t.id,name:t.name,name_ko:t.name_ko,brand:t.brand,type:t.type,burr:t.burr,burrSize:t.burrSize,adjustmentType:t.adjustmentType,description:t.description,description_ko:t.description_ko,imageUrl:t.imageUrl,settings:{create:r.map(e=>({name:e.name,name_ko:e.name_ko,value:e.value,brewingMethod:e.brewingMethod,description:e.description,description_ko:e.description_ko}))}}})}return{success:!0,message:"그라인더 데이터가 성공적으로 추가되었습니다."}}catch(e){return console.error("Error seeding grinders:",e),{success:!1,error:"그라인더 데이터 추가 중 오류가 발생했습니다."}}}async function g(){try{return await i.zR.grinderSetting.deleteMany({}),await i.zR.grinder.deleteMany({}),(0,a.revalidatePath)("/grinders"),{success:!0,message:"모든 그라인더 데이터가 삭제되었습니다."}}catch(e){return console.error("Error deleting all grinders:",e),{success:!1,error:"모든 그라인더 삭제 중 오류가 발생했습니다."}}}(0,t(52943).D)([o,c,u,d,l,p,f,g]),(0,n.A)(o,"4039b3fc82c7cae0300ca48d4319cafd00ddc15042",null),(0,n.A)(c,"4092f0d1ee2e78dba22d09bcc75a9574c3492e6295",null),(0,n.A)(u,"4057da01a1dedce3831aa62d6027cb70fc05ab7149",null),(0,n.A)(d,"609040d7801287eee927927e2a7433f58bda2cc5a0",null),(0,n.A)(l,"40881af8245ace9d7983511a91a5b37676d13fca1e",null),(0,n.A)(p,"60b74c88484bc97542423700fc9442ff98cfdb30c8",null),(0,n.A)(f,"00fa2d22aa2f0d457ac8459aed2f66c89232351aae",null),(0,n.A)(g,"0097f32c3c6834504afc7f51568955b58358dafa87",null)},44627:(e,r,t)=>{"use strict";t.d(r,{kR:()=>o,zR:()=>a});var n=t(96330);let i=global;i.isConnected||(i.isConnected=!1,i.connectionError=null,i.lastConnectionAttempt=0,i.connectionRetryCount=0);let a=i.prisma??function(){let e=process.env.DATABASE_URL;process.env.DIRECT_URL;let r={log:["error"],errorFormat:"pretty"};return e&&(r.datasources={db:{url:e}}),new n.PrismaClient(r)}();async function s(){try{let e=Date.now();if(i.isConnected)return{connected:!0,error:null};if(i.connectionError&&e-i.lastConnectionAttempt<3e4)return{connected:!1,error:i.connectionError};if(i.connectionRetryCount>=3){let r=e-i.lastConnectionAttempt;if(r<3e4)return{connected:!1,error:`${i.connectionError} (${Math.ceil((3e4-r)/1e3)}초 후 재시도 가능)`};i.connectionRetryCount=0}return i.lastConnectionAttempt=e,i.connectionRetryCount++,await a.user.findFirst({select:{id:!0},take:1}),i.isConnected=!0,i.connectionError=null,i.connectionRetryCount=0,{connected:!0,error:null}}catch(r){console.error("Database connection error:",r);let e="데이터베이스 연결 오류";return r instanceof Error&&(r.message.includes("P5010")||r.message.includes("fetch failed")?e="데이터베이스 서버에 연결할 수 없습니다. 네트워크 연결을 확인하거나 잠시 후 다시 시도해주세요.":r.message.includes("timeout")?e="데이터베이스 연결 시간이 초과되었습니다. 잠시 후 다시 시도해주세요.":r.message.includes("authentication")&&(e="데이터베이스 인증에 실패했습니다. 관리자에게 문의하세요.")),i.isConnected=!1,i.connectionError=e,{connected:!1,error:e}}}async function o(e,r,t){try{let n=await s();if(!n.connected)return t&&t(Error(n.error||"데이터베이스 연결 오류")),r;return await e()}catch(e){return console.error("Database operation error:",e),t&&t(e),r}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},46420:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>h,routeModule:()=>f,serverHooks:()=>b,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>m});var n={};t.r(n),t.d(n,{GET:()=>p});var i=t(48106),a=t(48819),s=t(12050),o=t(4235),c=t(36896),u=t(44627),d=t(83395),l=t(65208);async function p(e){try{if("true"!==process.env.NEXT_PUBLIC_SKIP_AUTH){let e=await (0,l.UL)(),r=(0,d.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL||"",process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",{cookies:{async get(r){let t=await e.get(r);return t?.value},set(){},remove(){}}}),{data:{user:t}}=await r.auth.getUser();if(!t?.email)return o.NextResponse.json({error:"인증이 필요합니다."},{status:401});let n=process.env.ADMIN_EMAIL||"admin@example.com";if(t.email!==n)return o.NextResponse.json({error:"관리자 권한이 필요합니다."},{status:403})}let r="true"===e.nextUrl.searchParams.get("force"),t=await u.zR.grinder.count();if(t>0&&!r)return o.NextResponse.json({message:"그라인더 데이터가 이미 존재합니다. 강제 업데이트하려면 ?force=true 파라미터를 사용하세요.",count:t},{status:200});r&&t>0&&await (0,c.v6)();let n=await (0,c.Kx)();if(n.success)return o.NextResponse.json({message:n.message,force:r},{status:200});return o.NextResponse.json({error:n.error},{status:500})}catch(e){return console.error("Error seeding grinder data:",e),o.NextResponse.json({error:"그라인더 데이터 시드 중 오류가 발생했습니다."},{status:500})}}let f=new i.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/grinders/seed/route",pathname:"/api/grinders/seed",filename:"route",bundlePath:"app/api/grinders/seed/route"},resolvedPagePath:"/Users/jelly/WebstormProjects/chocoya-coffee/app/webserver/src/app/api/grinders/seed/route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:g,workUnitAsyncStorage:m,serverHooks:b}=f;function h(){return(0,s.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:m})}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57414:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{INTERCEPTION_ROUTE_MARKERS:function(){return i},extractInterceptionRouteInformation:function(){return s},isInterceptionRouteAppPath:function(){return a}});let n=t(4773),i=["(..)(..)","(.)","(..)","(...)"];function a(e){return void 0!==e.split("/").find(e=>i.find(r=>e.startsWith(r)))}function s(e){let r,t,a;for(let n of e.split("/"))if(t=i.find(e=>n.startsWith(e))){[r,a]=e.split(t,2);break}if(!r||!t||!a)throw Object.defineProperty(Error("Invalid interception route: "+e+". Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>"),"__NEXT_ERROR_CODE",{value:"E269",enumerable:!1,configurable:!0});switch(r=(0,n.normalizeAppPath)(r),t){case"(.)":a="/"===r?"/"+a:r+"/"+a;break;case"(..)":if("/"===r)throw Object.defineProperty(Error("Invalid interception route: "+e+". Cannot use (..) marker at the root level, use (.) instead."),"__NEXT_ERROR_CODE",{value:"E207",enumerable:!1,configurable:!0});a=r.split("/").slice(0,-1).concat(a).join("/");break;case"(...)":a="/"+a;break;case"(..)(..)":let s=r.split("/");if(s.length<=2)throw Object.defineProperty(Error("Invalid interception route: "+e+". Cannot use (..)(..) marker at the root level or one level up."),"__NEXT_ERROR_CODE",{value:"E486",enumerable:!1,configurable:!0});a=s.slice(0,-2).concat(a).join("/");break;default:throw Object.defineProperty(Error("Invariant: unexpected marker"),"__NEXT_ERROR_CODE",{value:"E112",enumerable:!1,configurable:!0})}return{interceptingRoute:r,interceptedRoute:a}}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},80408:()=>{},81630:e=>{"use strict";e.exports=require("http")},87032:()=>{},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96330:e=>{"use strict";e.exports=require("@prisma/client")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[191,3395,5208,3796,3744,1344,4078],()=>t(46420));module.exports=n})();